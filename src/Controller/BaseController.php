<?php

namespace App\Controller;

use App\Entity\Users;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;

class BaseController extends AbstractController
{
    /**
     * @param Request $request
     *
     * @return bool
     */
    public function isAdmin(Request $request)
    {
        $cookies = $request->cookies;

        $login    = $cookies->get('login');
        if (!$login) {
            return false;
        }

        /** @var Users $user */
        $user     = $this->getDoctrine()->getRepository(Users::class)->findOneBy(['login' => $login]);
        $password = $cookies->get('password');
        if (!$user || !$password == $user->getPassword()) {
            return false;
        }

        return true;
    }
}
